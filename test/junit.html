

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="David Gayerie" name="author" />
<meta content="Les tests unitaires avec JUnit" name="description" />
<meta content="Java, JUnit, Mockito, mock, test unitaire" name="keywords" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Les tests unitaires automatisés avec JUnit &mdash; Documentation POEI Apside </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom_rtd_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Les tests d’acception" href="../test_acceptation/test_acceptation.html" />
    <link rel="prev" title="Sommaire" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> POEI Apside
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Recherche dans les pages" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Les tests unitaires</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Les tests unitaires automatisés avec JUnit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#junit">JUnit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#integration-de-junit-dans-un-projet-maven">Intégration de JUnit dans un projet Maven</a></li>
<li class="toctree-l3"><a class="reference internal" href="#structure-d-une-classe-de-test-junit">Structure d’une classe de test JUnit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execution-des-tests-junit">Exécution des tests JUnit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#utilisation-de-doublure">Utilisation de doublure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#implementation-d-objet-mock-avec-mockito">Implémentation d’objet mock avec Mockito</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Les tests d'acceptation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../test_acceptation/test_acceptation.html">Les tests d’acception</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../test_acceptation/test_acceptation.html#recette-fonctionnelle">Recette fonctionnelle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test_acceptation/test_acceptation.html#test-d-acceptation-agile">Test d’acceptation agile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test_acceptation/test_acceptation.html#notion-de-cas-de-test">Notion de cas de test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test_acceptation/test_acceptation.html#scenario-de-test">Scénario de test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test_acceptation/test_acceptation.html#rapport-de-test">Rapport de test</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">POEI Apside</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Accueil</a> &raquo;</li>
        
      <li>Les tests unitaires automatisés avec JUnit</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="../test_acceptation/test_acceptation.html" class="btn btn-neutral float-right" title="Les tests d’acception" accesskey="n">Suivant <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="Sommaire" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Précédent</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="les-tests-unitaires-automatises-avec-junit">
<h1>Les tests unitaires automatisés avec JUnit<a class="headerlink" href="#les-tests-unitaires-automatises-avec-junit" title="Lien permanent vers ce titre">¶</a></h1>
<p>Un test automatisé est un programme qui se découpe en trois étapes dites
AAA pour <em>Arrange</em>, <em>Act</em>, <em>Assert</em>.</p>
<dl class="simple">
<dt>Arrange</dt><dd><p>La mise en place de l’environnement : création et initialisation des
objets nécessaires à l’exécution du test.</p>
</dd>
<dt>Act</dt><dd><p>Le test proprement dit.</p>
</dd>
<dt>Assert</dt><dd><p>La vérification des résultats obtenus par le test.</p>
</dd>
</dl>
<p>Le sous-système (l’ensemble des objets) éprouvé par le test est parfois
appelé <strong>SUT</strong> (System Under Test).</p>
<p>On distingue différentes catégories de tests :</p>
<ul class="simple">
<li><p>Tests unitaires : testent une partie (une unité) d’un système afin de
s’assurer qu’il fonctionne correctement (<em>build the system right</em>)</p></li>
<li><p>Tests d’acceptation : testent le système afin de s’assurer qu’il est
conforme aux besoins (<em>build the right system</em>)</p></li>
<li><p>Tests d’intégration : testent le système sur une plate-forme proche
de la plate-forme cible</p></li>
<li><p>Tests de sécurité : testent que l’application ne contient pas de
failles de sécurité connues (injection de code, attaque XSS, …)</p></li>
<li><p>Tests de robustesse : testent le comportement de l’application au
limite des ressources disponibles (mémoire, CPU, …) sur la
plate-forme</p></li>
</ul>
<div class="section" id="junit">
<h2>JUnit<a class="headerlink" href="#junit" title="Lien permanent vers ce titre">¶</a></h2>
<p><a class="reference external" href="https://www.junit.org">JUnit</a> est le framework de tests unitaires le plus utilisé en Java.</p>
<div class="section" id="integration-de-junit-dans-un-projet-maven">
<h3>Intégration de JUnit dans un projet Maven<a class="headerlink" href="#integration-de-junit-dans-un-projet-maven" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour intégrer <a class="reference external" href="https://www.junit.org">JUnit</a> dans un projet Maven, il faut d’abord ajouter le jar
de <a class="reference external" href="https://www.junit.org">JUnit</a> dans le projet. Pour cela, il suffit d’ajouter la déclaration
suivante dans le fichier <code class="file docutils literal notranslate"><span class="pre">pom.xml</span></code> du projet dans la section
<code class="docutils literal notranslate"><span class="pre">&lt;dependencies&gt;</span></code> :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>4.12<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
<p>L’attribut scope est positionné à <code class="docutils literal notranslate"><span class="pre">test</span></code> dans la déclaration de
dépendance ci-dessus. Cela indique à Maven que la bibliothèque <a class="reference external" href="https://www.junit.org">JUnit</a> ne
doit être prise en compte que pour la compilation et l’exécution des
classes de test. Ainsi la bibliothèque <a class="reference external" href="https://www.junit.org">JUnit</a> ne sera pas incluse dans le
packaging de l’application finale. Par exemple, elle ne sera pas ajoutée
dans le fichier war si le projet est une application Web.</p>
<p>Les classes de test peuvent maintenant être implémentées en les plaçant
dans le répertoire de source <code class="file docutils literal notranslate"><span class="pre">src/test/java</span></code> du projet.</p>
</div>
<div class="section" id="structure-d-une-classe-de-test-junit">
<h3>Structure d’une classe de test JUnit<a class="headerlink" href="#structure-d-une-classe-de-test-junit" title="Lien permanent vers ce titre">¶</a></h3>
<p>Comme Java est un langage orienté Objet, les tests <a class="reference external" href="https://www.junit.org">JUnit</a> sont regroupés
dans des classes de test. Généralement, on groupe dans une classe les
tests ayant la même classe comme point d’entrée et on nomme la classe de
test à partir du nom de la classe testée préfixé ou suffixé par <code class="docutils literal notranslate"><span class="pre">Test</span></code>
en la plaçant dans le même package. Par exemple, pour tester la classe
<code class="docutils literal notranslate"><span class="pre">DateFormatter</span></code>, on créera une classe <code class="docutils literal notranslate"><span class="pre">TestDateFormatter</span></code> ou
<code class="docutils literal notranslate"><span class="pre">DateFormatterTest</span></code>.</p>
<p>Suffixer ou post-fixer par <code class="docutils literal notranslate"><span class="pre">Test</span></code> le nom de la classe de test est juste une
convention. Néanmoins il est très fortement conseillé de la respecter
car les IDE et Maven utilisent également cette convention pour découvrir
les classes de test à exécuter.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Exemple d’une classe de test</span><a class="headerlink" href="#id2" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">org.junit.Assert.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UneClasseTest</span> <span class="o">{</span>

  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">methodeDeTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">assertTrue</span><span class="o">(</span><span class="s">&quot;Une assertion&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<p>Une classe de test est simplement une classe déclarant des méthodes
publiques sans paramètre annotées par <a class="reference external" href="https://junit.org/javadoc/4.11/org/junit/Test.html">&#64;Test</a>.</p>
<p>Il est possible d’exécuter des méthodes avant et après chaque test pour
allouer et désallouer des ressources nécessaires à l’exécution des
tests. On utilise pour cela des méthodes publiques sans paramètre
annotées avec <a class="reference external" href="https://junit.org/javadoc/4.11/org/junit/Before.html">&#64;Before</a> et <a class="reference external" href="https://junit.org/javadoc/4.11/org/junit/After.html">&#64;After</a>.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Exemple d’une classe de test avec <a class="reference external" href="https://junit.org/javadoc/4.11/org/junit/Before.html">&#64;Before</a> et <a class="reference external" href="https://junit.org/javadoc/4.11/org/junit/After.html">&#64;After</a></span><a class="headerlink" href="#id3" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.junit.After</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import static</span> <span class="nn">org.junit.Assert.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UneClasseTest</span> <span class="o">{</span>

  <span class="nd">@Before</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initTestEnvironment</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// cette méthode est exécutée avant chaque test</span>
  <span class="o">}</span>

  <span class="nd">@After</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroyTestEnvironment</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// cette méthode est exécutée après chaque test</span>
  <span class="o">}</span>

  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">methodeDeTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">assertTrue</span><span class="o">(</span><span class="s">&quot;Une assertion&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<p>La classe <a class="reference external" href="https://junit.org/javadoc/4.11/org/junit/Assert.html">Assert</a> est une
classe outil contenant des méthodes statiques permettant de déclarer les
assertions des tests. Les assertions sont des méthodes suivants les
mêmes patrons de signature :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">les</span> <span class="n">assertions</span> <span class="n">impliquant</span> <span class="n">uniquement</span> <span class="n">la</span> <span class="n">valeur</span> <span class="n">récupérée</span> <span class="n">par</span> <span class="n">le</span> <span class="n">test</span>
<span class="o">//</span> <span class="n">comme</span> <span class="p">(</span><span class="n">Assert</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">)</span>
<span class="n">Assert</span><span class="o">.</span><span class="n">assertXXX</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">valeurActuelle</span><span class="p">);</span>
<span class="n">Assert</span><span class="o">.</span><span class="n">assertXXX</span><span class="p">(</span><span class="n">valeurActuelle</span><span class="p">);</span>

<span class="o">//</span> <span class="n">les</span> <span class="n">assertions</span> <span class="n">impliquant</span> <span class="n">une</span> <span class="n">comparaison</span> <span class="n">entre</span> <span class="n">une</span> <span class="n">valeur</span> <span class="n">attendue</span>
<span class="o">//</span> <span class="n">et</span> <span class="n">la</span> <span class="n">valeur</span> <span class="n">récupérée</span> <span class="n">par</span> <span class="n">le</span> <span class="n">test</span> <span class="p">(</span><span class="n">comme</span> <span class="n">Assert</span><span class="o">.</span><span class="n">assertEquals</span><span class="p">)</span>
<span class="n">Assert</span><span class="o">.</span><span class="n">assertXXX</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">valeurAttendue</span><span class="p">,</span> <span class="n">valeurActuelle</span><span class="p">);</span>
<span class="n">Assert</span><span class="o">.</span><span class="n">assertXXX</span><span class="p">(</span><span class="n">valeurAttendue</span><span class="p">,</span> <span class="n">valeurActuelle</span><span class="p">);</span>
</pre></div>
</div>
<p>Il existe également la méthode <a class="reference external" href="https://junit.org/javadoc/4.11/org/junit/Assert.html#assertThat%28T,%20org.hamcrest.Matcher%29">Assert.assertThat</a> qui permet une écriture plus riche des assertions :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="nn">org.junit.Assert.assertThat</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="nn">org.hamcrest.CoreMatchers.</span><span class="o">*</span><span class="p">;</span>

<span class="n">public</span> <span class="k">class</span> <span class="nc">UneClasseTest</span> <span class="p">{</span>

  <span class="nd">@Test</span>
  <span class="n">public</span> <span class="n">void</span> <span class="n">methodeDeTest</span><span class="p">()</span> <span class="n">throws</span> <span class="ne">Exception</span> <span class="p">{</span>
    <span class="n">assertThat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="ow">is</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
    <span class="n">assertThat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="ow">not</span><span class="p">(</span><span class="ow">is</span><span class="p">(</span><span class="mi">3</span><span class="p">)));</span>
  <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="execution-des-tests-junit">
<h3>Exécution des tests JUnit<a class="headerlink" href="#execution-des-tests-junit" title="Lien permanent vers ce titre">¶</a></h3>
<p><a class="reference external" href="https://www.junit.org">JUnit</a> est pris en charge par les IDE Java et par les outils de build
comme Maven.</p>
<p>Dans Eclipse, il suffit de faire un clique droit dans l’explorateur de
projet sur un fichier source, une classe de Test ou un package et de
choisir <strong>« Run as… &gt; JUnit Test »</strong>. On peut également presser la
touche F11 dans l’éditeur de code source de la classe de test.</p>
<p>Avec Maven, il suffit de lancer le goal <strong>test</strong> :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mvn <span class="nb">test</span>
</pre></div>
</div>
<div class="exercice admonition">
<p class="admonition-title">Exercice - Tests unitaires de java.util.Math#abs(int)</p>
<p>Écrire les tests unitaires pour la méthode
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Math.html#abs-int-">java.util.Math#abs(int)</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>L’exercice précédent propose de tester une méthode sans effet de bord
(ce que l’on appelle également une <a class="reference external" href="https://fr.wikipedia.org/wiki/Fonction_pure">fonction
pure</a>). Les tests sur ce
type de méthodes sont faciles à écrire. Ils restent cependant
l’exception lorsqu’on utilise la programmation orientée objet. En effet,
l’appel d’une méthode sur un objet modifie le plus souvent son état et
provoque généralement des effets de bord en sollicitant d’autres objets
avec lesquels l’objet entretient des dépendances.</p>
</div>
<div class="exercice admonition">
<p class="admonition-title">Exercice - Tests unitaires de la classe Duree</p>
<p>Écrire les tests unitaires de la classe <code class="docutils literal notranslate"><span class="pre">Duree</span></code>.</p>
<p>Vous pouvez télécharger le projet Maven complet : <a class="reference download internal" download="" href="../_downloads/8ea73d0c13240e710312e4dc2bef39b6/duree.zip"><code class="xref download docutils literal notranslate"><span class="pre">duree.zip</span></code></a></p>
</div>
</div>
</div>
<div class="section" id="utilisation-de-doublure">
<h2>Utilisation de doublure<a class="headerlink" href="#utilisation-de-doublure" title="Lien permanent vers ce titre">¶</a></h2>
<p>Parfois, il est utile de contrôler l’environnement de test d’un objet ou
d’une collaboration d’objets. Pour cela, on peut faire appel à des
doublures qui vont se substituer lors des tests aux objets réellement
utilisés lors de l’exécution de l’application dans un environnement de
production.</p>
<dl class="simple">
<dt>Simulateur</dt><dd><p>Un simulateur fournit une implémentation alternative d’un
sous-système. Un simulateur remplace un sous-système qui n’est pas
disponible pour l’environnement de test. Par exemple, on peut
remplacer un système de base de données par une implémentation
simplifiée en mémoire.</p>
</dd>
<dt>Fake object</dt><dd><p>Un fake object permet de remplacer un sous-système dont il est
difficile de garantir le comportement. Le comportement du fake
object est défini par le test et est donc déterministe. Par exemple,
si un objet dépend des informations retournées par un service Web,
il est souhaitable de remplacer pour les tests l’implémentation du
client par une implémentation qui retournera une réponse déterminée
par le test lui-même.</p>
</dd>
<dt>Mock object</dt><dd><p>Un objet mock est proche d’un fake object sauf qu’un objet mock est
également capable de faire des assertions sur les méthodes qui sont
appelées et les paramètres qui sont transmis à ces méthodes.</p>
</dd>
</dl>
<div class="section" id="implementation-d-objet-mock-avec-mockito">
<h3>Implémentation d’objet mock avec Mockito<a class="headerlink" href="#implementation-d-objet-mock-avec-mockito" title="Lien permanent vers ce titre">¶</a></h3>
<p><a class="reference external" href="https://site.mockito.org/">Mockito</a> est un framework Java
pour faciliter la création d’objets mocks à partir d’une classe ou d’une
interface.</p>
<p>Pour ajouter <a class="reference external" href="https://site.mockito.org/">Mockito</a> à un projet Maven, il suffit d’ajouter dans la
section <code class="docutils literal notranslate"><span class="pre">&lt;dependencies&gt;</span></code> du fichier <code class="file docutils literal notranslate"><span class="pre">pom.xml</span></code> :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.mockito<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>mockito-all<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.9.5<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
<p>La méthode statique <code class="docutils literal notranslate"><span class="pre">Mockito.mock(Class&lt;?&gt;)</span></code> permet de créer une
instance d’un mock à partir d’une classe ou d’une interface. L’instance
d’objet retournée par cette méthode est instrumentalisée par <a class="reference external" href="https://site.mockito.org/">Mockito</a>. Il
est possible d’enregistrer sur ce mock des comportements lors de la
phase <em>arrange</em> grâce, notamment, à la méthode <code class="docutils literal notranslate"><span class="pre">Mockito.when(Object)</span></code>.
Lors de la phase <em>assert</em>, il est possible de vérifier que les appels de
méthodes programmés sur le mock ont bien été réalisés grâce à la méthode
<code class="docutils literal notranslate"><span class="pre">Mockito.verify(Object)</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Exemple d’une classe de test utilisant Mockito</span><a class="headerlink" href="#id4" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import static</span> <span class="nn">org.hamcrest.CoreMatchers.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">org.junit.Assert.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mockito.Mockito</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestWithMockito</span> <span class="o">{</span>

  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testDemoMockito</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">HttpServletRequest</span> <span class="n">mockedRequest</span> <span class="o">=</span> <span class="n">Mockito</span><span class="o">.</span><span class="na">mock</span><span class="o">(</span><span class="n">HttpServletRequest</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">Mockito</span><span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">mockedRequest</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;login&quot;</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="s">&quot;monlogin&quot;</span><span class="o">);</span>

    <span class="n">String</span> <span class="n">parameterValue</span> <span class="o">=</span> <span class="n">mockedRequest</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;login&quot;</span><span class="o">);</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">parameterValue</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="s">&quot;monlogin&quot;</span><span class="o">));</span>
    <span class="n">Mockito</span><span class="o">.</span><span class="na">verify</span><span class="o">(</span><span class="n">mockedRequest</span><span class="o">).</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;login&quot;</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Utilisation de Mockito avec import static</span><a class="headerlink" href="#id5" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import static</span> <span class="nn">org.hamcrest.CoreMatchers.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">org.junit.Assert.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">org.mockito.Mockito.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestWithMockito</span> <span class="o">{</span>

  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testDemoMockito</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">HttpServletRequest</span> <span class="n">mockedRequest</span> <span class="o">=</span> <span class="n">mock</span><span class="o">(</span><span class="n">HttpServletRequest</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">when</span><span class="o">(</span><span class="n">mockedRequest</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;login&quot;</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="s">&quot;monlogin&quot;</span><span class="o">);</span>

    <span class="n">String</span> <span class="n">parameterValue</span> <span class="o">=</span> <span class="n">mockedRequest</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;login&quot;</span><span class="o">);</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">parameterValue</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="s">&quot;monlogin&quot;</span><span class="o">));</span>
    <span class="n">verify</span><span class="o">(</span><span class="n">mockedRequest</span><span class="o">).</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;login&quot;</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<p>Les exemples de code ci-dessus ne sont bien évidemment pas de vrais
tests <a class="reference external" href="https://www.junit.org">JUnit</a> puisqu’ils se contentent de tester le bon fonctionnement de
<a class="reference external" href="https://site.mockito.org/">Mockito</a>.</p>
<p>La documentation de <a class="reference external" href="https://site.mockito.org/">Mockito</a> est accessible
<a class="reference external" href="https://github.com/mockito/mockito/wiki">ici</a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../test_acceptation/test_acceptation.html" class="btn btn-neutral float-right" title="Les tests d’acception" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="Sommaire" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Précédent</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright David Gayerie - david.gayerie@epsi.fr - CC-BY-SA

    </p>
  </div>
    <div>Téléchargez ce support au format <a class="reference download" href="https://github.com/spoonless/poei_apside/archive/gh-pages.zip">HTML</a>
    </div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>